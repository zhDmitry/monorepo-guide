# Гайд по орагнизации монорепозитория

## overview

* Зачем ?
* Инструменты и способы ораганизации
* Сравнение инструментов
* Примеры
* Полезные ссылки

## Зачем ?

Монорепозиторий это способ организации когда, когда все разрабатываемые пакети и приложения находятся в единственном репозитории.
В чем преимущества перед обычной стратегией manyrepos ?

1.  Все процессы и изменения в репозиторий являются централизоваными.
2.  Тестирование и разработка связных компонентов приложения упрощается в разы.
3.  Упрощается настройка ci и тестов для репозитория т.к их нужно настроить только один раз.
4.  Упрощается процесс код ревью.
5.  При изменениях которые задевают несколько компонентов нужно создавать и ревьювить только один пул реквест.
6.  Комплексное тестирование на ci значително упрощается.

Из минусов можно вынести:

1.  Размер репоозитория очень быстро вырастает.
2.  История изменений может быть весьма запутанной.
3.  Если в монорепозитории находятся конечные приложения, то способ деплой может быть своеобразным

Что же даст переход на монорепозиторий ?

* Упрощение вокрфлоу,
* ускорения работы в постоянном меняющейся базе кода
* уменьшение количества файлов и зависимостей для разработки (prettier,eslint, husky .etc)

## Инструменты и способы ораганизации

### Вариант 1

Самый базовый случай использования монорепозитория это просто создать папку pacakges и при деплое приложения скачаевается вся папка, а зависимости подтягиваются с это папки.

### Вариант 2

Более сложный вариант, когда работа с модулем идет в две стороны как с монорепозитория, так и с отдельного репозитория для этого модуля.
Пример, вы создали библиотеку которую активно развивали в контексте вашего приватного монорепозитория, но потом сделали ее опенсорсной и вам нужно синхронизировать код между гитхабом и вашим монорепозиторием.

Сначала рассмотрим 1 вариант. У вас все пакеты находятся в одном репозитории и модификация модулей происходит только с монорепозитория. В таком случае для управления пакетами следует присмотреться к таким тулзам как lerna, yarn workspaces, bolt, oao, rush(). Эти инстурменты упрощают работу с множеством модулей, в особенности такие процессы как линкование зависимостей между модулями, уставновка дополнительных пакетов для модулей, массовые действия с пакетами.

Так же у вас может быть, что в монорепозитории вы развиваете библиотеку компонентов, которую потом используют ваши приложения в данном случае вам нужно делать publish компонентов в npm registry или свой собственный, а в зависящих приложениях модули уже будут скачиваться с помощью npm. C релизом и паблишем пакетов может помочь lerna, которая упрощает процес паблишинга модулей и апдейта зависимостей между модулями.
